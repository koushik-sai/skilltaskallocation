<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manager Dashboard</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    html {
      scroll-behavior: smooth;
    }

    .stars i {
      margin-right: 3px;
    }

    .sidebar {
      min-height: 100vh;
      border-right: 1px solid #dee2e6;
      background-color: #f8f9fa;
    }

    .sidebar .nav-link.active {
      font-weight: bold;
      color: #0d6efd !important;
    }

    .progress {
      height: 1rem;
    }

    .progress-bar {
      font-size: 0.75rem;
      line-height: 1rem;
    }

    .dashboard-container {
      background-color: #f8f9fa;
    }

    .chart {
      height: 200px;
      display: flex;
      align-items: flex-end;
      gap: 10px;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 5px;
    }

    .bar {
      width: 40px;
      background-color: #0d6efd;
      border-radius: 3px 3px 0 0;
    }

    .bar-1 { height: 60%; }
    .bar-2 { height: 80%; }
    .bar-3 { height: 45%; }
  </style>
</head>
<body>

  <div class="dashboard-container">
    <!-- Navbar -->
    <nav class="navbar navbar-dark bg-dark">
      <div class="container-fluid">
        <!-- <a class="navbar-brand" href="/manager-dashboard/#">Manager App</a> -->
        <span class="navbar-text text-white me-3">Welcome, {{ currentUser?.name}}</span>
        <div class="d-flex align-items-center">
          <!-- <span class="navbar-text text-white me-3">Welcome, Manager</span> -->
          <button (click)="handleLogout()" class="btn btn-outline-light btn-sm">
            <i class="bi bi-box-arrow-right" ></i> Logout
          </button>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 d-md-block sidebar">
          <div class="position-sticky pt-3">
           <ul class="nav flex-column">
  <li class="nav-item">
    <a class="nav-link fw-bold active" (click)="scrollToSection('dashboard')" style="cursor: pointer;">Dashboard</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" (click)="scrollToSection('tasks')" style="cursor: pointer;">Tasks</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" (click)="scrollToSection('skills')" style="cursor: pointer;">Skills</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" (click)="scrollToSection('team-members')" style="cursor: pointer;">Team</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" (click)="scrollToSection('report-filters')" style="cursor: pointer;">Reports</a>
  </li>
</ul>
          </div>
        </nav>

        <!-- Main Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
          <!-- Dashboard Header -->
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2" id="dashboard">Manager Dashboard</h1>
            <!-- <div class="btn-toolbar mb-2 mb-md-0">
              <button class="btn btn-success me-2">
                <i class="bi bi-plus-circle"></i> Create Task
              </button>
              <button class="btn btn-primary">
                <i class="bi bi-people"></i> Manage Team
              </button>
            </div> -->
          </div>


  <!-- Task Management Section -->
<div class="card mb-4" id="tasks">
  <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Task Management</h5>
    
    <div class="d-flex gap-2">
      <button class="btn btn-light btn-sm" (click)="fetchUserSkillData()">
        <i class="bi bi-search"></i> Fetch Skills
      </button>
      <button class="btn btn-light btn-sm" (click)="openCreateTaskModal()">
        <i class="bi bi-plus-circle"></i> Create Task
      </button>
    </div>
  </div>

  <div class="card-body">
    <div *ngIf="tasks.length === 0" class="text-muted">No tasks available.</div>

    <div class="table-responsive" *ngIf="tasks.length > 0">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Title</th>
            <th>Assigned To</th>
            <th>Deadline</th>
            <th>Status</th>
            <th>Progress</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of tasks">
            <td>{{ task.title }}</td>
            <td>{{ task.assignedTo || 'Unassigned' }}</td>
            <td>{{ task.deadline | date: 'mediumDate' }}</td>
            <td>
              <span class="badge"
                [ngClass]="{
                  'bg-success': task.status === 'COMPLETED',
                  'bg-warning': task.status === 'IN_PROGRESS',
                  'bg-danger': task.status === 'BLOCKED',
                  'bg-secondary': task.status === 'ASSIGNED'
                }">
                {{ task.status }}
              </span>
            </td>
            <td>
              <div class="progress">
                <div
                  class="progress-bar"
                  role="progressbar"
                  [style.width.%]="getProgress(task)"
                  [ngClass]="{
                    'bg-success': getProgress(task) === 100,
                    'bg-warning': getProgress(task) > 0 && getProgress(task) < 100,
                    'bg-danger': getProgress(task) === 0
                  }">
                  {{ getProgress(task) }}%
                </div>
              </div>
            </td>
            <td>
              <button class="btn btn-sm btn-outline-primary me-1" (click)="editTask(task)">
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="deleteTask(task.taskId!)">
                <i class="bi bi-trash"></i> Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- ðŸ”½ User Skill Data Modal -->
<div *ngIf="showUserSkillModal" class="modal-overlay" (click)="closeUserSkillModalOnBackground($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h5 class="modal-title">
        <i class="bi bi-person-gear"></i> User Skill Data
      </h5>
      <button type="button" class="btn-close" (click)="closeUserSkillModal()"></button>
    </div>
    <div class="modal-body">
      <div *ngIf="userSkillData.length > 0; else noSkillData">
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>User ID</th>
                <th>Skill ID</th>
                <th>Skill Name</th>
                <th>Proficiency Level</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let entry of userSkillData">
                <td><span class="badge bg-primary">{{ entry.userId }}</span></td>
                <td><span class="badge bg-secondary">{{ entry.skillId }}</span></td>
                <td>{{ entry.skillName }}</td>
                <td><span class="badge bg-success">{{ entry.proficiencyLevel }}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <ng-template #noSkillData>
        <div class="text-center text-muted py-4">
          <i class="bi bi-info-circle fs-1 text-muted"></i>
          <p class="mt-2">No user skill data available.</p>
        </div>
      </ng-template>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeUserSkillModal()">
        <i class="bi bi-x-circle"></i> Close
      </button>
    </div>
  </div>
</div>

  <!-- Task Modal (Create/Edit Task) -->
  <div *ngIf="showTaskModal" class="modal-overlay" (click)="closeTaskModalOnBackground($event)">
  <div class="modal-content modal-lg" (click)="$event.stopPropagation()">
    <form (ngSubmit)="submitTaskForm()" #taskFormRef="ngForm">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="bi bi-clipboard-plus"></i>
          {{ selectedTask ? 'Edit Task' : 'Create Task' }}
        </h5>
        <button type="button" class="btn-close" (click)="closeTaskModal()"></button>
      </div>
      <div class="modal-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label for="title" class="form-label">Title</label>
            <input id="title" class="form-control" [(ngModel)]="taskForm.title" name="title" required placeholder="Enter task title" />
          </div>
          <div class="col-md-6">
            <label for="assignedTo" class="form-label">Assigned To (User ID)</label>
            <input id="assignedTo" type="number" class="form-control" [(ngModel)]="taskForm.assignedTo" name="assignedTo" required placeholder="Enter user ID" />
          </div>
          <div class="col-md-6">
            <label for="priority" class="form-label">Priority</label>
            <select id="priority" class="form-select" [(ngModel)]="taskForm.priority" name="priority" required>
              <option value="" disabled>Select priority</option>
              <option value="LOW">Low</option>
              <option value="MEDIUM">Medium</option>
              <option value="HIGH">High</option>
            </select>
          </div>
          <div class="col-md-6">
            <label for="status" class="form-label">Status</label>
            <select id="status" class="form-select" [(ngModel)]="taskForm.status" name="status" required>
              <option value="" disabled>Select status</option>
              <option value="ASSIGNED">Assigned</option>
              <option value="IN_PROGRESS">In Progress</option>
              <option value="BLOCKED">Blocked</option>
              <option value="COMPLETED">Completed</option>
            </select>
          </div>
          <div class="col-md-4">
            <label for="startDate" class="form-label">Start Date</label>
            <input id="startDate" type="date" class="form-control" [(ngModel)]="taskForm.startDate" name="startDate" required />
          </div>
          <div class="col-md-4">
            <label for="endDate" class="form-label">End Date</label>
            <input id="endDate" type="date" class="form-control" [(ngModel)]="taskForm.endDate" name="endDate" required />
          </div>
          <div class="col-md-4">
            <label for="deadline" class="form-label">Deadline</label>
            <input id="deadline" type="date" class="form-control" [(ngModel)]="taskForm.deadline" name="deadline" required />
          </div>
          <div class="col-md-6">
            <label for="estimatedHours" class="form-label">Estimated Hours</label>
            <input id="estimatedHours" type="number" class="form-control" [(ngModel)]="taskForm.estimatedHours" name="estimatedHours" placeholder="0" />
          </div>
          <div class="col-md-6">
            <label for="actualHours" class="form-label">Actual Hours</label>
            <input id="actualHours" type="number" class="form-control" [(ngModel)]="taskForm.actualHours" name="actualHours" placeholder="0" />
          </div>
          <div class="col-md-12">
            <label for="requiredSkillId" class="form-label">Required Skill ID</label>
            <input id="requiredSkillId" type="number" class="form-control" [(ngModel)]="taskForm.requiredSkillId" name="requiredSkillId" required placeholder="Enter skill ID" />
          </div>
          
          <div class="col-md-12">
            <label for="description" class="form-label">Description</label>
            <textarea id="description" class="form-control" [(ngModel)]="taskForm.description" name="description" rows="4" placeholder="Enter task description..."></textarea>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeTaskModal()">
          <i class="bi bi-x-circle"></i> Cancel
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="!taskFormRef.form.valid">
          <i class="bi bi-check-circle"></i>
          {{ selectedTask ? 'Update Task' : 'Create Task' }}
        </button>
      </div>
    </form>
  </div>
</div>
  

         
           <!-- Skill Management Section -->
<div class="card mb-4" id="skills">
  <div class="card-header bg-success text-white">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Skill Management</h5>
      <button class="btn btn-light btn-sm" (click)="openSkillModal()">
        <i class="bi bi-plus-circle"></i> Add Skill
      </button>
    </div>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-success">
          <tr>
            <th>Skill Name</th>
            <th>Description</th>
            <th>Category</th>
            <th>Level</th>
            <th>Created At</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody *ngIf="skills.length > 0; else noSkills">
          <tr *ngFor="let skill of skills">
            <td><span class="badge bg-primary">{{ skill.skillName }}</span></td>
            <td>{{ skill.skillDescription || 'â€”' }}</td>
            <td>{{ skill.category || 'â€”' }}</td>
            <td><span class="badge bg-secondary">{{ skill.level }}</span></td>
            <td>{{ skill.createdAt | date: 'short' }}</td>
            <td>
              <button class="btn btn-sm btn-outline-primary me-1" (click)="editSkill(skill)">
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="deleteSkill(skill.skillId!)">
                <i class="bi bi-trash"></i> Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- No skills fallback -->
      <ng-template #noSkills>
        <div class="text-center text-muted mt-3">No skills available.</div>
      </ng-template>
    </div>
  </div>
</div>

<!-- Skill Modal (controlled via showSkillModal boolean) -->
<div *ngIf="showSkillModal" class="modal-overlay" (click)="closeSkillModalOnBackground($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h5 class="modal-title">
        <i class="bi bi-gear-fill"></i>
        {{ selectedSkill ? 'Edit Skill' : 'Add Skill' }}
      </h5>
      <button type="button" class="btn-close" (click)="closeSkillModal()"></button>
    </div>
    <div class="modal-body">
      <form (ngSubmit)="submitSkillForm()" #skillFormRef="ngForm">
        <div class="row g-3">
          <div class="col-12">
            <label for="skillName" class="form-label">Skill Name</label>
            <input type="text" id="skillName" class="form-control" [(ngModel)]="skillForm.skillName" name="skillName" required placeholder="Enter skill name" />
          </div>
          <div class="col-12">
            <label for="skillDescription" class="form-label">Description</label>
            <textarea id="skillDescription" class="form-control" [(ngModel)]="skillForm.skillDescription" name="skillDescription" rows="3" placeholder="Enter skill description..."></textarea>
          </div>
          <div class="col-md-6">
            <label for="category" class="form-label">Category</label>
            <input type="text" id="category" class="form-control" [(ngModel)]="skillForm.category" name="category" placeholder="e.g., Programming, Design" />
          </div>
          <div class="col-md-6">
            <label for="level" class="form-label">Level</label>
            <select id="level" class="form-select" [(ngModel)]="skillForm.level" name="level">
              <option value="" disabled>Select level</option>
              <option value="BEGINNER">Beginner</option>
              <option value="INTERMEDIATE">Intermediate</option>
              <option value="ADVANCED">Advanced</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeSkillModal()">
            <i class="bi bi-x-circle"></i> Cancel
          </button>
          <button type="submit" class="btn btn-success" [disabled]="!skillFormRef.form.valid">
            <i class="bi bi-check-circle"></i>
            {{ selectedSkill ? 'Update Skill' : 'Add Skill' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


        <div class="card mb-4" id="team-members">
  <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Team Member Management</h5>

    <!-- Buttons container -->
    <div>
      <!-- Single View button -->
      <button class="btn btn-light btn-sm me-2" (click)="showRequestsTable = true">
        <i class="bi bi-eye"></i> View Requests
      </button>

      <!-- Add Member button -->
      <button class="btn btn-light btn-sm" (click)="openMemberModal()">
        <i class="bi bi-plus-circle"></i> Add Member
      </button>
    </div>
  </div>

  <!-- Requests Table, toggled by View button -->
  <div *ngIf="showRequestsTable" class="card-body mt-3">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Username</th>
          <th>User ID</th>
          <th>Task ID</th>
          <th>Message</th>
          <th>Status</th>
          <th>Request Date</th>
          <th>Responded By</th>
          <th>Responded At</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of requests">
          <td>{{request.username}}</td>
          <td>{{ request.userId }}</td>
          <td>{{ request.taskId }}</td>
          <td>{{ request.requestMessage }}</td>
          <td>{{ request.status }}</td>
          <td>{{ request.requestDate | date:'medium' }}</td>
          <td>{{ request.respondedBy || '-' }}</td>
          <td>{{ request.respondedAt ? (request.respondedAt | date:'medium') : '-' }}</td>
        </tr>
      </tbody>
    </table>
    <button class="btn btn-secondary btn-sm mt-3" (click)="showRequestsTable = false">Close Requests</button>
  </div>

        
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle">
                <thead class="table-primary">
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Skills</th>
                    <th>Tasks</th>
                    <th>Workload</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody *ngIf="teamMembers.length > 0; else noMembers">
                  <tr *ngFor="let member of teamMembers">
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center text-white me-2" style="width: 32px; height: 32px; font-size: 14px;">
                          {{ getInitials(member.name) }}
                        </div>
                        {{ member.name }}
                      </div>
                    </td>
                    <td>{{ member.email }}</td>
                    <td>
                      <span *ngFor="let skill of member.skills" class="badge bg-secondary me-1">{{ skill }}</span>
                    </td>
                    <td>
                      <span *ngFor="let task of member.tasks" class="badge bg-warning me-1">{{ task.title }}</span>
                      <span class="badge bg-info">{{ member.tasks.length }} total</span>
                    </td>
                    <td>
                      <div class="progress" style="width: 80px;">
                        <div class="progress-bar bg-warning" [style.width.%]="member.workload">{{ member.workload }}</div>
                      </div>
                    </td>
                    <td>
                      <!-- <button class="btn btn-sm btn-outline-info me-1" (click)="viewMemberDetails(member)">
                        <i class="bi bi-eye"></i> View
                      </button> -->
                      <!-- <div *ngFor="let request of requests">
              <button class="btn btn-sm btn-info mb-1" (click)="viewRequest(request)">View Request #{{ request.requestId }}</button>
            </div> -->

                      <button class="btn btn-sm btn-outline-primary" (click)="assignTaskToMember1(member)">
                        <i class="bi bi-plus-circle"></i> Assign Task
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
        
              <!-- No members fallback -->
              <ng-template #noMembers>
                <div class="text-center text-muted mt-3">No team members available.</div>
              </ng-template>
            </div>
          </div>
        </div>
        <!-- Add Member Modal -->
<div *ngIf="showMemberModal" class="modal-overlay" (click)="closeMemberModalOnBackground($event)">
  <div class="modal-content p-4 shadow rounded" style="max-width: 600px; width: 100%;">
    <h5 class="mb-4 text-success d-flex align-items-center">
      <i class="bi bi-person-plus-fill me-2"></i> Add Team Member
    </h5>

    <form (ngSubmit)="submitAddMemberForm()" #addMemberForm="ngForm">

      <div class="row g-3">
        <div class="col-md-6">
          <label for="userId" class="form-label">User ID</label>
          <input type="number" id="userId" class="form-control" name="userId"
                 [(ngModel)]="newMember.userId" placeholder="e.g. 10" required>
        </div>

        <div class="col-md-6">
          <label for="teamId" class="form-label">Team ID</label>
          <input type="number" id="teamId" class="form-control" name="teamId"
                 [(ngModel)]="newMember.teamId" placeholder="e.g. 1" required>
        </div>

        <div class="col-md-6">
          <label for="skillId" class="form-label">Skill ID</label>
          <input type="number" id="skillId" class="form-control" name="skillId"
                 [(ngModel)]="newMember.skillId" placeholder="e.g. 3" required>
        </div>

        <div class="col-md-6">
          <label for="taskId" class="form-label">Task ID</label>
          <input type="number" id="taskId" class="form-control" name="taskId"
                 [(ngModel)]="newMember.taskId" placeholder="e.g. 4" required>
        </div>

        <div class="col-md-6">
          <label for="joinedOn" class="form-label">Joined On</label>
          <input type="date" id="joinedOn" class="form-control" name="joinedOn"
                 [(ngModel)]="newMember.joinedOn" required>
        </div>

        <div class="col-md-6">
          <label for="roleInTeam" class="form-label">Role in Team</label>
          <input type="text" id="roleInTeam" class="form-control" name="roleInTeam"
                 [(ngModel)]="newMember.roleInTeam" placeholder="e.g. Frontend Developer" required>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button type="button" class="btn btn-outline-secondary me-2" (click)="closeMemberModal()">
          <i class="bi bi-x-circle"></i> Cancel
        </button>
        <button type="submit" class="btn btn-success" [disabled]="!addMemberForm.form.valid">
          <i class="bi bi-person-check-fill"></i> Add Member
        </button>
      </div>

    </form>
  </div>
</div>

<!-- Assign Task Modal -->
<div *ngIf="showAssignTaskModal1"
     class="modal-overlay d-flex align-items-center justify-content-center"
     style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5); z-index: 1050; overflow-y: auto;"
     (click)="closeAssignTaskModalOnBackground($event)">

  <div class="modal-content p-4 shadow-lg rounded bg-white"
       style="max-width: 720px; width: 100%; margin: 2rem auto;"
       (click)="$event.stopPropagation()">

    <!-- Modal Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h5 class="text-primary m-0">
        <i class="bi bi-clipboard-plus me-2"></i> Assign New Task
      </h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="closeAssignTaskModal1()"></button>
    </div>

    <!-- Form -->
    <form (ngSubmit)="submitAssignTaskForm()" #assignTaskForm="ngForm">
      <div class="row g-3">

        <div class="col-md-6">
          <label class="form-label">Task ID</label>
          <input type="number" class="form-control" [(ngModel)]="newTask.taskId" name="taskId" />
        </div>

        <div class="col-md-6">
          <label class="form-label">Title</label>
          <input type="text" class="form-control" [(ngModel)]="newTask.title" name="title" required />
        </div>

        <div class="col-md-6">
          <label class="form-label">Assigned To (User ID)</label>
          <input type="text" class="form-control" [(ngModel)]="newTask.assignedTo" name="assignedTo" />
        </div>

        <div class="col-md-6">
          <label class="form-label">Priority</label>
          <select class="form-select" [(ngModel)]="newTask.priority" name="priority" required>
            <option value="" disabled>Select priority</option>
            <option value="LOW">Low</option>
            <option value="MEDIUM">Medium</option>
            <option value="HIGH">High</option>
          </select>
        </div>

        <div class="col-md-6">
          <label class="form-label">Status</label>
          <select class="form-select" [(ngModel)]="newTask.status" name="status" required>
            <option value="" disabled>Select status</option>
            <option value="ASSIGNED">Assigned</option>
            <option value="IN_PROGRESS">In Progress</option>
            <option value="COMPLETED">Completed</option>
            <option value="BLOCKED">Blocked</option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Start Date</label>
          <input type="date" class="form-control" [(ngModel)]="newTask.startDate" name="startDate" required />
        </div>

        <div class="col-md-4">
          <label class="form-label">End Date</label>
          <input type="date" class="form-control" [(ngModel)]="newTask.endDate" name="endDate" required />
        </div>

        <div class="col-md-4">
          <label class="form-label">Deadline</label>
          <input type="date" class="form-control" [(ngModel)]="newTask.deadline" name="deadline" required />
        </div>

        <div class="col-md-6">
          <label class="form-label">Estimated Hours</label>
          <input type="number" class="form-control" [(ngModel)]="newTask.estimatedHours" name="estimatedHours" />
        </div>

        <div class="col-md-6">
          <label class="form-label">Actual Hours</label>
          <input type="number" class="form-control" [(ngModel)]="newTask.actualHours" name="actualHours" />
        </div>

        <div class="col-md-6">
          <label class="form-label">Required Skill ID</label>
          <input type="number" class="form-control" [(ngModel)]="newTask.requiredSkillId" name="requiredSkillId" required />
        </div>

        <div class="col-md-6">
          <label class="form-label">Created By</label>
          <input type="number" class="form-control" [(ngModel)]="newTask.createdBy" name="createdBy" required />
        </div>

        <div class="col-md-12">
          <label class="form-label">Description</label>
          <textarea rows="3" class="form-control" [(ngModel)]="newTask.description" name="description"></textarea>
        </div>

      </div>

      <!-- Form Actions -->
      <div class="d-flex justify-content-end mt-4">
        <button type="button" class="btn btn-outline-secondary me-2" (click)="closeAssignTaskModal1()">
          <i class="bi bi-x-circle"></i> Cancel
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="!assignTaskForm.form.valid">
          <i class="bi bi-check-circle-fill"></i> Assign Task
        </button>
      </div>
    </form>
  </div>
</div>


          
     <div class="card mb-4" id="report-filters">
  <div class="card-header bg-info text-white">
    <h5>Fetch Reports</h5>
  </div>
  <div class="card-body">
    <div class="row g-3 align-items-end">
      <!-- Status select -->
      <div class="col-md-3">
        <label for="report-status" class="form-label">Status</label>
        <select id="report-status" class="form-select" [(ngModel)]="reportStatus">
          <option *ngFor="let status of reportStatusOptions" [value]="status">{{status}}</option>
        </select>
      </div>
      <div class="col-md-3">
        <button class="btn btn-primary w-100" (click)="fetchReportsByStatus()">
          Fetch by Status
        </button>
      </div>

      <!-- Date range -->
      <div class="col-md-3">
        <label for="date-from" class="form-label">From</label>
        <input type="date" id="date-from" class="form-control" [(ngModel)]="dateFrom">
      </div>
      <div class="col-md-3">
        <label for="date-to" class="form-label">To</label>
        <input type="date" id="date-to" class="form-control" [(ngModel)]="dateTo">
      </div>
      <div class="col-md-3">
        <button class="btn btn-primary w-100" (click)="fetchReportsByDateRange()">
          Fetch by Date Range
        </button>
      </div>

      <!-- By user -->
      <div class="col-md-3">
        <label for="user-id" class="form-label">User ID</label>
        <input type="number" id="user-id" class="form-control" [(ngModel)]="userId">
      </div>
      <div class="col-md-3">
        <button class="btn btn-primary w-100" (click)="fetchReportsByUser()">
          Fetch by User
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Only show report section if reports exist -->
<div *ngIf="reports && reports.length > 0" class="card mt-4">

  <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Reports</h5>
    <div>
      <button class="btn btn-outline-light btn-sm me-2" (click)="downloadCSV()">Download CSV</button>
      <button class="btn btn-outline-light btn-sm" (click)="printPDF()">Download PDF</button>
      <button class="btn btn-outline-light btn-sm me-2" (click)="downloadExcel()">Download Excel</button>

    </div>
  </div>

  <div class="card-body">
    <div id="print-section">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Report ID</th>
            <th>Title</th>
            <th>Status</th>
            <th>Date</th>
            <th>User</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let report of reports">
            <td>{{ report.reportId || report.id }}</td>
            <td>{{ report.title }}</td>
            <td>{{ report.status }}</td>
            <td>{{ report.reportDate | date:'shortDate' }}</td>
            <td>{{ report.userId || report.user?.id }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- No reports found message -->
<div *ngIf="reports && reports.length === 0" class="alert alert-warning mt-4">
  No reports found.
</div>
</main>
</div>
</div>
</div>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>